<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure AI Chatbot</title>
    <link rel="stylesheet" href="style.css">

    <!--
      SECURITY HEADERS: These meta tags instruct the browser on how to handle content and requests,
      enhancing security against common web vulnerabilities.
    -->

    <!-- CSP (Content Security Policy)
         Defines approved sources for content, mitigating XSS and data injection attacks.
         - default-src 'self': Allows content from the same origin by default.
         - script-src: Specifies allowed sources for JavaScript. Includes 'self', Google for reCAPTCHA, and Cloudflare for Turnstile.
         - style-src: Specifies allowed sources for CSS. 'unsafe-inline' is included for the anti-cloning/honeypot styles.
                      For maximum security, move all styles to style.css and remove 'unsafe-inline'.
         - img-src: Allows images from 'self' and data URIs.
         - font-src: Allows fonts from 'self'.
         - frame-src: Specifies allowed sources for iframes (used by reCAPTCHA/Turnstile).
         - connect-src: Restricts URLs for XHR, WebSockets, Fetch API. Crucial for controlling where data can be sent.
                        Update 'https://your-cloudflare-ai-endpoint.example.com' to your actual AI backend.
         - object-src 'none': Disallows plugins like Flash, reducing attack surface.
         - base-uri 'self': Restricts the URLs that can be used in a document's <base> element.
    -->
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self';
                   script-src 'self' https://www.google.com https://www.gstatic.com https://challenges.cloudflare.com;
                   style-src 'self' 'unsafe-inline';
                   img-src 'self' data:;
                   font-src 'self';
                   frame-src https://www.google.com https://www.gstatic.com https://challenges.cloudflare.com;
                   connect-src 'self' https://your-cloudflare-ai-endpoint.example.com;
                   object-src 'none';
                   base-uri 'self';">
    <!-- Other Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY"> <!-- Prevents clickjacking -->
    <meta name="referrer-policy" content="strict-origin-when-cross-origin">
    <meta name="robots" content="noindex, nofollow, noarchive, nosnippet"> <!-- Discourage search engine indexing and caching -->
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=(), payment=(), usb=()"> <!-- Feature policy to disable unnecessary browser features -->

    <style>
        /* Anti-cloning: Basic CSS to make it slightly harder to copy-paste all content directly. */
        body {
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE 10 and IE 11 */
            user-select: none; /* Standard syntax */
            /* Basic styling for the main page content */
            font-family: sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        .main-website-header, .main-website-content, .main-website-footer {
            padding: 20px;
            max-width: 900px;
            margin: 20px auto;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        /* Honeypot field styling - ensure it's truly invisible and not accessible by users or assistive tech. */
        .honeypot-field {
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            height: 0;
            width: 0;
            z-index: -1; /* Send it behind other content */
            pointer-events: none; /* Make sure it cannot be interacted with */
        }

        /* Initially hide the chat container and style the launcher */
        /* Styles for chat-container when visible are in style.css, here we ensure it's hidden and positioned */
        .chat-container-wrapper { /* New wrapper for positioning */
            display: none; /* Hidden by default */
            pointer-events: none; /* Ignore mouse events when hidden */
            position: fixed;
            bottom: 20px; /* Distance from bottom of viewport */
            right: 20px;  /* Distance from right of viewport */
            z-index: 1000; /* Ensure it's above most other content */
            /* width: auto; /* Width will be determined by its content or by .chat-container's max-width */
            max-width: 420px; /* A more typical pop-up chat width */
            /* height: auto; /* Height will be determined by its content or by .chat-container's max-height */
            max-height: calc(100vh - 100px); /* Max height, leaving some space from top/bottom, e.g. 80vh or fixed like 600px */
            /* To prevent it from being too small if content is minimal, .chat-container can have min-height */
            /* Box shadow for the wrapper itself to lift it off the page */
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            border-radius: 12px; /* Match .chat-container's border-radius if it has one */
            overflow: hidden; /* Ensures children (.chat-container) respect the wrapper's border-radius */
        }
        .chat-container-wrapper.active {
            display: flex; /* Using flex to make .chat-container fill it easily */
            flex-direction: column; /* Stack children vertically if any other elements were in wrapper */
            pointer-events: auto; /* Allow mouse events when active */
        }


        #chatbotLauncher {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #6a0dad; /* Purple */
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 28px; /* Emoji/icon size */
            line-height: 60px; /* Center emoji vertically */
            text-align: center; /* Center emoji horizontally */
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            z-index: 1001;
            transition: background-color 0.3s, transform 0.2s;
        }
        #chatbotLauncher:hover {
            background-color: #5e0ca5; /* Darker purple */
            transform: scale(1.1);
        }
        #chatbotLauncher.hidden {
            display: none; /* Hide launcher when chat is open */
        }
    </style>
</head>
<body>
    <header class="main-website-header">
        <h1>Welcome to Our Awesome Website!</h1>
        <p>This page demonstrates how a chatbot can be integrated and activated on click.</p>
    </header>

    <main class="main-website-content">
        <section>
            <h2>About Us</h2>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. Mauris massa. Vestibulum lacinia arcu eget nulla.</p>
        </section>
        <section>
            <h2>Our Services</h2>
            <p>Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur sodales ligula in libero. Sed dignissim lacinia nunc. Curabitur tortor. Pellentesque nibh. Aenean quam. In scelerisque sem at dolor. Maecenas mattis. Sed convallis tristique sem. Proin ut ligula vel nunc egestas porttitor.</p>
        </section>
    </main>

    <footer class="main-website-footer">
        <p>&copy; 2024 Jules AI Assistant Services</p>
    </footer>

    <!-- Chatbot Launcher Icon/Button -->
    <button id="chatbotLauncher" aria-label="Open Chat">ðŸ’¬</button>

    <!-- Wrapper for the chat container for positioning and visibility control -->
    <div class="chat-container-wrapper" id="chatContainerWrapper">
        <!-- The existing chat-container div will be placed here by script or be here directly -->
        <!-- For simplicity, moving the existing chat-container inside -->
        <div class="chat-container" id="aiChatbotContainer" role="dialog" aria-modal="true" aria-labelledby="chatHeaderTitle">
            <header class="chat-header">
                <h1 id="chatHeaderTitle">AI Chatbot</h1>
                <button id="closeChatbot" aria-label="Close Chat" style="background:none; border:none; color:white; font-size:24px; position:absolute; top:12px; right:15px; cursor:pointer; padding:5px;">&times;</button>
            </header>
            <div class="chat-messages" id="chatMessages" aria-live="polite" aria-atomic="false">
                <!-- Initial message will be added by script after verification -->
            </div>
            <div class="security-check-container" id="securityCheckContainer">
                <p><em>Please verify you are human to chat:</em></p>
                <div id="captchaPlaceholder">
                    <!-- CAPTCHA widget (reCAPTCHA/Turnstile) will be rendered here by script.js -->
                </div>
            </div>
            <footer class="chat-input-area">
                <form id="chatForm" action="javascript:void(0);">
                    <div class="honeypot-field" aria-hidden="true">
                        <label for="contact_me_by_fax_only">Contact me by fax only</label>
                        <input type="checkbox" name="contact_me_by_fax_only" id="contact_me_by_fax_only" value="1" tabindex="-1" autocomplete="off">
                    </div>
                    <input type="text" id="userInput" placeholder="Type your message..." autocomplete="off" disabled aria-label="User message input">
                    <button type="submit" id="sendButton" disabled>Send</button>
                </form>
            </footer>
        </div>
    </div>

    <!-- CAPTCHA API scripts (reCAPTCHA/Turnstile) will be loaded dynamically by script.js
         when the chat is opened. This avoids loading them if the user doesn't interact with the chatbot.
    -->
    <!-- For reference, direct script loading would look like:
    <script src="https://www.google.com/recaptcha/api.js?onload=onRecaptchaApiLoad&render=explicit" async defer></script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onTurnstileApiLoad&render=explicit" async defer></script>
    -->

    <script src="script.js"></script>
</body>
</html>
